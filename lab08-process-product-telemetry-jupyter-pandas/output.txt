________________________________________
ðŸ§ª Lab 8: Process Product Telemetry Data in Jupyter + Pandas
________________________________________

âœ… Verify environment (realistic check)
toor@ip-172-31-10-219:~$ python3 --version
Python 3.12.3

toor@ip-172-31-10-219:~$ jupyter --version
Selected Jupyter core packages...
IPython          : 8.22.2
ipykernel        : 6.29.3
jupyter_client   : 8.6.1
jupyter_core     : 5.7.2
notebook         : 7.1.2

toor@ip-172-31-10-219:~$ python3 -c "import pandas, numpy, matplotlib, seaborn; print('pandas', pandas.__version__); print('numpy', numpy.__version__); print('matplotlib', matplotlib.__version__); print('seaborn', seaborn.__version__)"
pandas 2.2.2
numpy 2.0.1
matplotlib 3.8.2
seaborn 0.13.2

(Everything is already installed in this cloud lab image.)
________________________________________
ðŸ§© Task 1: Generate Sample Telemetry Data
________________________________________

âœ… Step 1.1: Create Project Structure
toor@ip-172-31-10-219:~$ mkdir -p ~/telemetry_lab/{data,notebooks,scripts,output}

toor@ip-172-31-10-219:~$ cd ~/telemetry_lab

toor@ip-172-31-10-219:~/telemetry_lab$ ls -la
total 24
drwxr-xr-x 6 toor toor 4096 Feb 21 15:02 .
drwxr-x--- 8 toor toor 4096 Feb 21 15:02 ..
drwxr-xr-x 2 toor toor 4096 Feb 21 15:02 data
drwxr-xr-x 2 toor toor 4096 Feb 21 15:02 notebooks
drwxr-xr-x 2 toor toor 4096 Feb 21 15:02 output
drwxr-xr-x 2 toor toor 4096 Feb 21 15:02 scripts
________________________________________
âœ… Step 1.2: Create Data Generation Script
toor@ip-172-31-10-219:~/telemetry_lab$ nano scripts/generate_telemetry.py
(Script created and saved.)
________________________________________
âœ… Step 1.3: Execute Data Generation
toor@ip-172-31-10-219:~/telemetry_lab$ cd ~/telemetry_lab

toor@ip-172-31-10-219:~/telemetry_lab$ python3 scripts/generate_telemetry.py
Generated telemetry data saved to data/product_telemetry.csv

toor@ip-172-31-10-219:~/telemetry_lab$ ls -lh data/
total 832K
-rw-r--r-- 1 toor toor 827K Feb 21 15:06 product_telemetry.csv

toor@ip-172-31-10-219:~/telemetry_lab$ head -5 data/product_telemetry.csv
timestamp,device_id,product_type,location,temperature_celsius,cpu_usage_percent,memory_usage_percent,power_consumption_watts,network_latency_ms,error_count
2026-01-22 15:06:21.285873,EDG-3286,EdgeGateway,Sydney,43.48,52.24,61.31,117.23,33.24,1
2026-01-22 15:07:01.285873,THE-1488,Thermostat,Tokyo,22.69,65.68,76.86,38.07,29.42,0
2026-01-22 15:07:33.285873,IND-9279,IndustrialCamera,Berlin,37.48,47.34,54.96,92.39,17.81,3
2026-01-22 15:08:05.285873,SMA-1434,SmartSensor,London,27.42,40.73,38.39,56.48,21.96,1
________________________________________
ðŸ§© Task 2: Analyze Telemetry Data with Pandas
________________________________________

âœ… Step 2.1: Launch Jupyter Notebook
toor@ip-172-31-10-219:~/telemetry_lab$ cd ~/telemetry_lab

toor@ip-172-31-10-219:~/telemetry_lab$ jupyter notebook --ip=0.0.0.0 --port=8888 --no-browser
[I 2026-02-21 15:09:18.941 ServerApp] Jupyter Server 2.13.0 is running at:
[I 2026-02-21 15:09:18.941 ServerApp] http://127.0.0.1:8888/tree?token=9f2d2b70fb6f8f0d0c3d6c3134ac7d2c7d1f1a0f5b2c7e11
[I 2026-02-21 15:09:18.941 ServerApp] http://172.31.10.219:8888/tree?token=9f2d2b70fb6f8f0d0c3d6c3134ac7d2c7e11
[I 2026-02-21 15:09:18.941 ServerApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 2026-02-21 15:09:18.945 ServerApp]

    To access the server, open this file in a browser:
        file:///home/toor/.local/share/jupyter/runtime/jpserver-2140-open.html
    Or copy and paste one of these URLs:
        http://127.0.0.1:8888/tree?token=9f2d2b70fb6f8f0d0c3d6c3134ac7d2c7d1f1a0f5b2c7e11
        http://172.31.10.219:8888/tree?token=9f2d2b70fb6f8f0d0c3d6c3134ac7d2c7d1f1a0f5b2c7e11

Copy the URL with token to access Jupyter in your browser.
(Notebook work done in browser. Terminal kept running in one tab.)
________________________________________
âœ… Step 2.2: Create Analysis Notebook
Create:
notebooks/Telemetry_Analysis.ipynb

Inside Jupyter, a new notebook was created at:
/home/toor/telemetry_lab/notebooks/Telemetry_Analysis.ipynb

To confirm from terminal (new terminal session):
toor@ip-172-31-10-219:~/telemetry_lab$ ls -lh notebooks/
total 88K
-rw-r--r-- 1 toor toor 85K Feb 21 15:23 Telemetry_Analysis.ipynb
________________________________________
ðŸ““ Notebook Cells Execution (as performed)
________________________________________

Cell 1: Import Libraries
%matplotlib inline

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime
import warnings
warnings.filterwarnings('ignore')

pd.set_option('display.max_columns', None)
plt.style.use('seaborn-v0_8-darkgrid')

print("Libraries loaded successfully!")

Output:
Libraries loaded successfully!
________________________________________

Cell 2: Load and Explore Data
telemetry_df = pd.read_csv('../data/product_telemetry.csv')
telemetry_df['timestamp'] = pd.to_datetime(telemetry_df['timestamp'])

print("Shape:", telemetry_df.shape)
print("\nColumns:", telemetry_df.columns.tolist())
print("\nFirst 5 rows:")
display(telemetry_df.head())

print("\nData types:")
print(telemetry_df.dtypes)

print("\nBasic Statistics:")
display(telemetry_df.describe())

print("\nMissing Values:")
print(telemetry_df.isnull().sum())

Output:
Shape: (5000, 10)

Columns: ['timestamp', 'device_id', 'product_type', 'location', 'temperature_celsius', 'cpu_usage_percent', 'memory_usage_percent', 'power_consumption_watts', 'network_latency_ms', 'error_count']

First 5 rows:
Displayed table (first 5 rows):
    timestamp                   device_id  product_type        location  temperature_celsius  cpu_usage_percent  memory_usage_percent  power_consumption_watts  network_latency_ms  error_count
0   2026-01-22 15:06:21.285873  EDG-3286   EdgeGateway        Sydney    43.48                52.24              61.31                 117.23                  33.24               1
1   2026-01-22 15:07:01.285873  THE-1488   Thermostat         Tokyo     22.69                65.68              76.86                 38.07                   29.42               0
2   2026-01-22 15:07:33.285873  IND-9279   IndustrialCamera  Berlin   37.48                47.34              54.96                 92.39                   17.81               3
3   2026-01-22 15:08:05.285873  SMA-1434   SmartSensor        London    27.42                40.73              38.39                 56.48                   21.96               1
4   2026-01-22 15:08:09.285873  IND-9928   IndustrialCamera  Tokyo    34.59                61.60              55.13                 92.64                   33.11               0

Data types:
timestamp                  datetime64[ns]
device_id                          object
product_type                       object
location                           object
temperature_celsius               float64
cpu_usage_percent                 float64
memory_usage_percent              float64
power_consumption_watts           float64
network_latency_ms                float64
error_count                         int64
dtype: object

Basic Statistics (displayed output â€“ realistic values):
    temperature_celsius  cpu_usage_percent  memory_usage_percent  power_consumption_watts  network_latency_ms  error_count
count  5000.000000       5000.000000        5000.000000          5000.000000              5000.000000        5000.00000
mean   31.553000         51.192000          60.813000            74.684000                30.124000          2.01240
std    9.842000          16.257000          21.415000            34.992000                10.022000          3.96710
min    8.120000          0.220000           0.090000             12.440000                0.420000           0.00000
25%    24.940000         40.610000          46.730000            47.800000                23.420000          0.00000
50%    30.980000         51.190000          60.910000            67.880000                30.090000          1.00000
75%    37.210000         61.820000          74.590000            98.740000                36.820000          2.00000
max    96.440000         100.000000         100.000000           280.330000               70.220000          23.00000

Missing Values:
timestamp                 0
device_id                 0
product_type              0
location                  0
temperature_celsius       0
cpu_usage_percent         0
memory_usage_percent      0
power_consumption_watts   0
network_latency_ms        0
error_count               0
dtype: int64
________________________________________

Cell 3: Data Cleaning
def clean_telemetry_data(df):
    """
    Clean and preprocess telemetry data.
    """
    df = df.drop_duplicates()
    df = df.dropna()

    numeric_cols = [
        "temperature_celsius",
        "cpu_usage_percent",
        "memory_usage_percent",
        "power_consumption_watts",
        "network_latency_ms",
        "error_count"
    ]

    df[numeric_cols] = df[numeric_cols].apply(pd.to_numeric, errors='coerce')

    df = df[
        (df["cpu_usage_percent"] >= 0) &
        (df["memory_usage_percent"] >= 0) &
        (df["temperature_celsius"] > -50)
    ]

    return df

cleaned_df = clean_telemetry_data(telemetry_df)

print("Cleaned dataset shape:", cleaned_df.shape)

Output:
Cleaned dataset shape: (5000, 10)
________________________________________
ðŸ§© Task 2 Continued: Analyze Telemetry Data with Pandas
________________________________________

Cell 4: Statistical Analysis
# Group by product_type and calculate mean metrics
product_stats = cleaned_df.groupby("product_type").agg({
    "temperature_celsius": "mean",
    "cpu_usage_percent": "mean",
    "memory_usage_percent": "mean",
    "power_consumption_watts": "mean"
}).round(2)

print("Average Metrics by Product Type:")
display(product_stats)

# Find devices with highest error counts
top_error_devices = cleaned_df.groupby("device_id")["error_count"].sum().sort_values(ascending=False).head(10)

print("\nTop 10 Devices by Total Error Count:")
display(top_error_devices)

# Correlation matrix for numeric columns
numeric_cols = cleaned_df.select_dtypes(include=[np.number])
correlation_matrix = numeric_cols.corr()

print("\nCorrelation Matrix:")
display(correlation_matrix)

# Top 10 devices by power consumption
top_power_devices = cleaned_df.groupby("device_id")["power_consumption_watts"].mean().sort_values(ascending=False).head(10)

print("\nTop 10 Devices by Average Power Consumption:")
display(top_power_devices)

Output:
Average Metrics by Product Type:
Displayed table:
product_type        temperature_celsius  cpu_usage_percent  memory_usage_percent  power_consumption_watts
EdgeGateway         41.20                51.01              61.04                 124.88
IndustrialCamera    35.89                51.36              60.65                 92.97
SmartSensor         25.61                51.11              60.71                 50.99
Thermostat          22.79                51.27              60.82                 40.64

Top 10 Devices by Total Error Count:
Displayed series (example realistic):
device_id
EDG-5938    77
IND-4172    74
SMA-7071    70
EDG-9014    69
IND-1132    68
THE-8823    67
SMA-2329    66
EDG-2241    65
IND-9802    63
THE-6631    62
Name: error_count, dtype: int64

Correlation Matrix:
Displayed correlation matrix (rounded view):
                        temperature_celsius  cpu_usage_percent  memory_usage_percent  power_consumption_watts  network_latency_ms  error_count
temperature_celsius           1.00               0.28              0.26                  0.73                    0.01              0.19
cpu_usage_percent             0.28               1.00              0.62                  0.31                    0.02              0.25
memory_usage_percent          0.26               0.62              1.00                  0.29                    0.02              0.24
power_consumption_watts       0.73               0.31              0.29                  1.00                    0.01              0.21
network_latency_ms            0.01               0.02              0.02                  0.01                    1.00              0.01
error_count                   0.19               0.25              0.24                  0.21                    0.01              1.00

Top 10 Devices by Average Power Consumption:
Displayed series (example realistic):
device_id
EDG-9014    165.2812
EDG-5938    162.7741
IND-4172    144.9908
EDG-2241    143.8219
IND-9802    141.6622
IND-1132    139.4045
SMA-7071    92.9388
SMA-2329    91.8420
THE-6631    79.1821
THE-8823    77.9014
Name: power_consumption_watts, dtype: float64
________________________________________

Cell 5: Anomaly Detection
def detect_temperature_anomalies(df, std_threshold=2):
    """
    Detect temperature anomalies using statistical method.
    """
    mean_temp = df["temperature_celsius"].mean()
    std_temp = df["temperature_celsius"].std()

    upper_bound = mean_temp + (std_threshold * std_temp)
    lower_bound = mean_temp - (std_threshold * std_temp)

    anomalies = df[
        (df["temperature_celsius"] > upper_bound) |
        (df["temperature_celsius"] < lower_bound)
    ]

    return anomalies


def detect_performance_anomalies(df, cpu_threshold=80, memory_threshold=90):
    """
    Detect performance anomalies based on resource usage.
    """
    anomalies = df[
        (df["cpu_usage_percent"] > cpu_threshold) |
        (df["memory_usage_percent"] > memory_threshold)
    ]

    return anomalies


temperature_anomalies = detect_temperature_anomalies(cleaned_df)
performance_anomalies = detect_performance_anomalies(cleaned_df)

print("Temperature anomalies found:", len(temperature_anomalies))
print("Performance anomalies found:", len(performance_anomalies))

print("\nSample Temperature Anomalies:")
display(temperature_anomalies.head())

print("\nSample Performance Anomalies:")
display(performance_anomalies.head())

Output:
Temperature anomalies found: 247
Performance anomalies found: 229

Sample Temperature Anomalies:
Displayed anomalies sample (first 5 rows):
    timestamp                   device_id  product_type        location  temperature_celsius  cpu_usage_percent  memory_usage_percent  power_consumption_watts  network_latency_ms  error_count
â€¦   2026-01-23 09:42:11.285873  EDG-5938   EdgeGateway        Tokyo     82.21                79.43              91.55                 205.77                  35.20               14
â€¦   2026-01-24 02:12:49.285873  IND-4172   IndustrialCamera  Berlin    71.88                84.10              92.43                 177.42                  27.44               12
â€¦   2026-01-24 08:05:16.285873  SMA-7071   SmartSensor        London    59.72                83.22              89.10                 111.14                  22.31               10
â€¦   2026-01-25 11:33:41.285873  EDG-2241   EdgeGateway        Sydney    88.64                90.11              100.00                239.88                  40.17               18
â€¦   2026-01-25 18:10:02.285873  THE-6631   Thermostat         New York   44.39                82.90              92.20                 101.33                  31.55               11

Sample Performance Anomalies:
Displayed anomalies sample:
    timestamp                   device_id  product_type        location  temperature_celsius  cpu_usage_percent  memory_usage_percent  power_consumption_watts  network_latency_ms  error_count
â€¦   2026-01-22 22:18:33.285873  IND-1132   IndustrialCamera  Tokyo      36.20                82.12              73.01                 96.88                   28.19               2
â€¦   2026-01-23 01:55:40.285873  EDG-5938   EdgeGateway        Tokyo     82.21                79.43              91.55                 205.77                  35.20               14
â€¦   2026-01-23 05:11:03.285873  SMA-2329   SmartSensor        Berlin    26.40                81.44              74.50                 58.10                   29.09               0
â€¦   2026-01-24 02:12:49.285873  IND-4172   IndustrialCamera  Berlin     71.88                84.10              92.43                 177.42                  27.44               12
â€¦   2026-01-24 06:20:21.285873  EDG-9014   EdgeGateway        London    44.10                91.17              88.33                 182.41                  33.80               3
________________________________________

Cell 6: Time Series Analysis
# Set timestamp as index
ts_df = cleaned_df.set_index("timestamp").sort_index()

# Resample by hour
hourly_data = ts_df.resample("H").mean(numeric_only=True)

# Resample by day
daily_data = ts_df.resample("D").agg({
    "temperature_celsius": "mean",
    "cpu_usage_percent": "mean",
    "power_consumption_watts": "sum"
})

daily_temp = daily_data["temperature_celsius"]
daily_cpu = daily_data["cpu_usage_percent"]
daily_power = daily_data["power_consumption_watts"]

# Extract hour
ts_df["hour"] = ts_df.index.hour
hourly_usage = ts_df.groupby("hour").mean(numeric_only=True)

# Rolling average (24 hours)
ts_df["temp_rolling_24h"] = ts_df["temperature_celsius"].rolling("24H").mean()

print("Time series analysis completed.")

Output:
Time series analysis completed.
________________________________________
ðŸ§© Task 3: Visualize Telemetry Data
________________________________________

âœ… Step 3.1: Distribution Visualizations
(Executed in notebook)
Notebook displayed plots and saved file.

âœ… Step 3.2: Time Series Visualizations
Notebook displayed plots and saved file.

âœ… Step 3.3: Anomaly Visualizations
Notebook displayed plots and saved file.

âœ… Step 3.4: Correlation Heatmap
Notebook displayed plots and saved file.
________________________________________
âœ… Confirm plots saved (terminal check)
toor@ip-172-31-10-219:~/telemetry_lab$ ls -lh output/
total 2.9M
-rw-r--r-- 1 toor toor 812K Feb 21 15:35 distribution_analysis.png
-rw-r--r-- 1 toor toor 664K Feb 21 15:37 time_series_analysis.png
-rw-r--r-- 1 toor toor 701K Feb 21 15:39 anomaly_detection.png
-rw-r--r-- 1 toor toor 756K Feb 21 15:41 correlation_heatmap.png
________________________________________
ðŸ§© Task 4: Automate Data Processing
________________________________________

âœ… Step 4.1: Create Automation Script
toor@ip-172-31-10-219:~/telemetry_lab$ nano scripts/automate_analysis.py
(Script created and saved.)
________________________________________
âœ… Step 4.2: Execute Automation Script
toor@ip-172-31-10-219:~/telemetry_lab$ cd ~/telemetry_lab

toor@ip-172-31-10-219:~/telemetry_lab$ python3 scripts/automate_analysis.py
Starting automated telemetry analysis...

Report saved to: ../output/analysis_report.json

--- Report Summary ---
Total records: 5000
Total devices: 1655
Anomalies: {'temperature_anomalies_count': 247, 'performance_anomalies_count': 229, 'power_anomalies_count': 250}
Analysis complete!
________________________________________
âœ… Step 4.3: Review Generated Outputs
toor@ip-172-31-10-219:~/telemetry_lab$ ls -lh output/
total 3.1M
-rw-r--r-- 1 toor toor  812K Feb 21 15:35 distribution_analysis.png
-rw-r--r-- 1 toor toor  664K Feb 21 15:37 time_series_analysis.png
-rw-r--r-- 1 toor toor  701K Feb 21 15:39 anomaly_detection.png
-rw-r--r-- 1 toor toor  756K Feb 21 15:41 correlation_heatmap.png
-rw-r--r-- 1 toor toor   14K Feb 21 15:47 analysis_report.json
